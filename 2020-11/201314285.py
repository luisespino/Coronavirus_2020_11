from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.metrics import mean_squared_error, r2_score
import matplotlib.pyplot as plt
import numpy as np
import random
#percentage of men infected by covid-19
#Data can be downloaded by following this link -> https://tablerocovid.mspas.gob.gt/
#Extra analisys was applied to extract useful data 
X = [
	1,
	2,
	3,
	4,
	5,
	6,
	7,
	8,
	9,
	10,
	11,
	12,
	13,
	14,
	15,
	16,
	17,
	18,
	19,
	20,
	21,
	22,
	23,
	24,
	25,
	26,
	27,
	28,
	29,
	30,
	31,
	32,
	33,
	34,
	35,
	36,
	37,
	38,
	39,
	40,
	41,
	42,
	43,
	44,
	45,
	46,
	47,
	48,
	49,
	50,
	51,
	52,
	53,
	54,
	55,
	56,
	57,
	58,
	59,
	60,
	61,
	62,
	63,
	64,
	65,
	66,
	67,
	68,
	69,
	70,
	71,
	72,
	73,
	74,
	75,
	76,
	77,
	78,
	79,
	80,
	81,
	82,
	83,
	84,
	85,
	86,
	87,
	88,
	89,
	90,
	91,
	92,
	93,
	94,
	95,
	96,
	97,
	98,
	99,
	100,
	101,
	102,
	103,
	104,
	105,
	106,
	107,
	108,
	109,
	110,
	111,
	112,
	113,
	114,
	115,
	116,
	117,
	118,
	119,
	120,
	121,
	122,
	123,
	124,
	125,
	126,
	127,
	128,
	129,
	130,
	131,
	132,
	133,
	134,
	135,
	136,
	137,
	138,
	139,
	140,
	141,
	142,
	143,
	144,
	145,
	146,
	147,
	148,
	149,
	150,
	151,
	152,
	153,
	154,
	155,
	156,
	157,
	158,
	159,
	160,
	161,
	162,
	163,
	164,
	165,
	166,
	167,
	168,
	169,
	170,
	171,
	172,
	173,
	174,
	175,
	176,
	177,
	178,
	179,
	180,
	181,
	182,
	183,
	184,
	185,
	186,
	187,
	188,
	189,
	190,
	191,
	192,
	193,
	194,
	195,
	196,
	197,
	198,
	199,
	200,
	201,
	202,
	203,
	204,
	205,
	206,
	207,
	208,
	209,
	210,
	211,
	212,
	213,
	214,
	215,
	216,
	217,
	218,
	219,
	220,
	221,
	222,
	223,
	224,
	225,
	226,
	227,
	228,
	229,
	230,
	231,
	232,
	233,
	234,
	235,
	236,
	237,
	238,
	239,
	240,
	241,
	242,
	243,
	244,
	245,
	246,
	247,
	248,
	249,
	250,
	251,
	252,
	253,
	254,
	255,
	256,
	257,
	258,
	259,
	260,
	261,
	262,
	263,
	264,
	265,
	266,
	267,
	268,
	269,
	270,
	271
]

Y = [
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0,
	0.566481463314575,
	0.566481463314575,
	3.39888877988745,
	0,
	1.13296292662915,
	1.13296292662915,
	2.83240731657288,
	1.69944438994373,
	0.566481463314575,
	1.13296292662915,
	0,
	2.2659258532583,
	0.566481463314575,
	2.2659258532583,
	2.2659258532583,
	1.69944438994373,
	0,
	2.2659258532583,
	2.83240731657288,
	3.39888877988745,
	3.39888877988745,
	4.5318517065166,
	3.96537024320203,
	3.96537024320203,
	2.83240731657288,
	6.23129609646033,
	21.5262956059539,
	8.49722194971863,
	7.36425902308948,
	1.69944438994373,
	5.66481463314575,
	9.0637034130332,
	40.2201838953348,
	5.66481463314575,
	10.7631478029769,
	7.93074048640405,
	5.09833316983118,
	1.69944438994373,
	19.2603697526956,
	40.2201838953348,
	13.5955551195498,
	29.4570360923579,
	36.8212951154474,
	10.7631478029769,
	7.93074048640405,
	16.4279624361227,
	15.2949995094935,
	17.5609253627518,
	27.1911102390996,
	11.3296292662915,
	9.0637034130332,
	13.5955551195498,
	24.9251843858413,
	26.624628775785,
	37.387776578762,
	26.0581473124705,
	56.0816648681429,
	49.283887308368,
	27.7575917024142,
	64.5788868178616,
	73.0761087675802,
	103.099626323253,
	87.2381453504446,
	78.1744419374114,
	60.6135165746595,
	108.197959493084,
	158.048328264766,
	144.452773145217,
	259.448510198075,
	314.397212139589,
	292.870916533635,
	140.487402902015,
	115.562218516173,
	347.819618475149,
	325.726841405881,
	231.690918495661,
	249.818325321728,
	226.59258532583,
	108.764440956398,
	64.012405354547,
	210.731104353022,
	203.366845329932,
	254.916658491559,
	250.384806785042,
	326.85980433251,
	303.067582873298,
	181.840549723979,
	335.357026282229,
	392.005172613686,
	420.895727242729,
	440.156096995425,
	407.866653586494,
	287.20610190049,
	253.217214101615,
	556.851278438227,
	524.561835029297,
	479.809799427445,
	408.433135049809,
	501.902576496714,
	397.669987246832,
	179.57462387072,
	605.002202819966,
	669.581089637828,
	649.754238421818,
	759.651642304845,
	735.859420845633,
	491.705910157051,
	206.76573410982,
	535.891464295588,
	921.665340812814,
	757.385716451587,
	748.888494501868,
	697.905162803557,
	487.740539913849,
	206.199252646505,
	683.743126220692,
	688.274977927209,
	704.702940363332,
	623.129609646033,
	569.880352094463,
	410.132579439752,
	241.321103372009,
	639.557572082155,
	608.401091599854,
	597.071462333562,
	635.025720375639,
	556.284796974913,
	368.212951154474,
	190.904253137012,
	673.54645988103,
	563.649055998002,
	588.574240383844,
	534.758501368959,
	545.521649171936,
	319.49554530942,
	160.314254118025,
	669.581089637828,
	597.071462333562,
	454.884615041604,
	461.682392601379,
	470.179614551097,
	316.663137992848,
	219.794807766055,
	586.8747959939,
	471.312577477727,
	500.769613570084,
	407.30017212318,
	382.374987737338,
	287.20610190049,
	158.048328264766,
	446.9538745552,
	419.196282852786,
	384.640913590597,
	386.906839443855,
	355.750358961553,
	258.882028734761,
	209.598141426393,
	483.208688207333,
	405.034246269921,
	382.374987737338,
	414.097949682954,
	390.305728223742,
	226.026103862515,
	161.447217044654,
	425.427578949246,
	389.172765297113,
	389.172765297113,
	357.449803351497,
	368.779432617788,
	197.702030696787,
	129.724255099038,
	378.409617494136,
	373.311284324305,
	330.825174575712,
	339.888877988745,
	285.506657510546,
	196.002586306843,
	116.128699979488,
	406.16720919655,
	363.114617984643,
	306.466471653185,
	367.079988227845,
	354.617396034924,
	212.430548742966,
	133.123143878925,
	403.901283343292,
	195.436104843528,
	377.276654567507,
	356.316840424868,
	389.739246760428,
	298.535731166781,
	189.771290210383,
	432.225356509021,
	431.092393582392,
	401.068876026719,
	399.93591310009,
	338.755915062116,
	193.736660453585,
	129.157773635723,
	374.444247250934,
	345.553692621891,
	309.298878969758,
	334.224063355599,
	327.426285795824,
	171.077401921002,
	117.828144369432,
	380.10906188408,
	339.888877988745,
	321.194989699364,
	306.466471653185,
	321.194989699364,
	189.771290210383,
	109.330922419713,
	329.125730185768,
	340.45535945206,
	300.801657020039,
	280.408324340715,
	285.506657510546,
	146.15221753516,
	121.793514612634,
	346.120174085205,
	208.465178499764,
	280.974805804029,
	308.165916043129,
	303.634064336612,
	156.348883874823,
	99.7007375433652,
	316.096656529533,
	277.009435560827,
	280.408324340715,
	250.951288248357,
	258.315547271446,
	141.053884365329,
	82.706293643928,
	160.314254118025,
	278.708879950771,
	202.233882403303,
	189.771290210383,
	135.389069732183,
	78.7409234007259,
	69.1107385243782,
	89.5040712037029
]
X = np.asarray(X)
Y = np.asarray(Y)
X = X[:,np.newaxis]
Y = Y[:,np.newaxis]
plt.scatter(X,Y)  

nb_degree = 4
polynomial_features = PolynomialFeatures(degree = nb_degree) 
X_TRANSF = polynomial_features.fit_transform(X)  

model = LinearRegression() 
model.fit(X_TRANSF, Y)  

Y_NEW = model.predict(X_TRANSF)  
rmse = np.sqrt(mean_squared_error(Y,Y_NEW)) 
r2 = r2_score(Y,Y_NEW)  

print('RMSE: ', rmse) 
print('R2: ', r2)

#Prediction will run on day 350 after covid-19 hit Guatemala
X_NEW = np.linspace(0, 350, 50) 
X_NEW = X_NEW[:,np.newaxis]  

X_NEW_TRANSF = polynomial_features.fit_transform(X_NEW)  
Y_NEW = model.predict(X_NEW_TRANSF)  

plt.plot(X_NEW, Y_NEW, color='blue', linewidth=3)  

plt.grid()  
plt.xlim(0,350)  
plt.ylim(0,2000)  

title = 'Degree = {}; RMSE = {}; R2 = {}'.format(nb_degree, round(rmse,2), round(r2,2))
plt.title('Guatemala \n ' + title, fontsize=10)
plt.xlabel('Days')  
plt.ylabel('Infecteds')  
plt.savefig("veliz.png", bbox_inches='tight') 
plt.show()